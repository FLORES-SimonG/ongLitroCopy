---
import DasboardLayouts from "../../../../../layouts/DasboardLayouts.astro";
import AsideMenuUser from "../../../../../components/AsideMenuDasboard/AsideMenuUser.astro";
import rectangle from "../../../../../assets/rectangleCard.svg";
import ButtonCTASmall from "../../../../../components/Buttons/ButtonCTASmall.astro";
import socio from "../../../../../assets/sersponsor.jpg";
import { jwtDecode } from "jwt-decode";
import { postSubscription } from "../../../../../helpers/Donations/postSubscription";

let responseUrl = "";
const tokenUser = Astro.cookies.get("token")?.value || '';
let emailDecodificado = "";

if (tokenUser) {
  try {
    const decodedToken: any = jwtDecode(tokenUser);
    emailDecodificado = decodedToken.userPayload.email;
    responseUrl = await postSubscription(emailDecodificado);
    console.log(decodedToken.userPayload.email);
  } catch (error) {
    console.error("Error decoding token:", error);
  }
}


---

<DasboardLayouts title="DashboardAdmin - Un Litro Alta Gracia.">
    <div class="flex flex-row h-screen bg-secondary">
      <div class="w-1/3 h-full pl-14 py-10">
        <AsideMenuUser
          ><h3 class="text-3xl font-medium text-primary">
            Menu de control
          </h3></AsideMenuUser
        >
      </div>
      <div class="h-full w-full px-14 py-10 flex flex-col justify-between">
        <div
          class="shadown-3xl rounded-xl bg-textPrimary shadow-3xl p-10 flex flex-col justify-around h-full gap-4"
        >
          <h4 class="text-2xl font-medium text-primary  w-full text-end ">
            SUMATE A NOSOTROS
          </h4>
          <div class="flex flex-row gap-5 justify-center items-center m-10">
           
         
            <div
              class="h-96 w-80 rounded-3xl shadow-3xl transition-all hover:shadow-4xl cursor-pointer "
            >
              <a href="/dashboardUser/profile/optionSelected/socio">
                <img
                  src={socio.src}
                  alt="imagen"
                  class="absolute h-80 w-80 object-cover rounded-3xl"
                />
                <img
                  src={rectangle.src}
                  alt="fondo card"
                  class="absolute h-96 w-80 rounded-3xl my-10"
                />
                <div class="relative top-64">
                  <div class="flex flex-col items-center gap-5">
                    <h6 class="font-semibold text-lg">Ser socio/a</h6>
                    <a href={responseUrl} data-mp="MP-payButton">
                      <ButtonCTASmall title="¡Participar!" />
                    </a>
                  </div>
                  
                </div>
              </a>
            </div>
            <div class="w-1/2 flex flex-col gap-5">
                <h5 class="text-xl font-semibold">¡Sé parte de nuestro equipo de socios/as!</h5>
                <p>Lorem, ipsum dolor sit amet consectetur adipisicing elit. Officia expedita itaque placeat, saepe sit velit deserunt nemo iure. Quasi facere maxime corrupti obcaecati harum molestiae libero possimus tempora atque laborum?</p>
                <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Dolor iusto id, dolores deleniti vitae, minima neque velit nihil nam reiciendis magnam aliquam rem libero expedita delectus itaque cumque. Corrupti, delectus!</p>
            </div>
          </div>
          <div class=" w-full flex justify-end absolute bottom-14 right-20">
            <a
              href="/dashboardUser/profile"
              class="bg-secondary text-textSecondary px-10 py-1 rounded-full text-lg shadow-3xl hover:scale-105 focus:shadow-none font-medium h-min w-min whitespace-nowrap mx-6"
            >
              Anterior
            </a>
          </div>
        </div>
        </div>
      </div>
    </div>
  </DasboardLayouts>
  
  <script type="text/javascript">
    (function() {
       function $MPC_load() {
          window.$MPC_loaded !== true && (function() {
          var s = document.createElement("script");
          s.type = "text/javascript";
          s.async = true;
          s.src = document.location.protocol + "//secure.mlstatic.com/mptools/render.js";
          var x = document.getElementsByTagName('script')[0];
          x.parentNode.insertBefore(s, x);
          window.$MPC_loaded = true;
       })();
    }
    window.$MPC_loaded !== true ? (window.attachEvent ? window.attachEvent('onload', $MPC_load) : window.addEventListener('load', $MPC_load, false)) : null;
    })();
   /*
         // to receive event with message when closing modal from congrants back to site
         function $MPC_message(event) {
           // onclose modal ->CALLBACK FUNCTION
          // !!!!!!!!FUNCTION_CALLBACK HERE Received message: {event.data} preapproval_id !!!!!!!!
         }
         window.$MPC_loaded !== true ? (window.addEventListener("message", $MPC_message)) : null; 
         */
 </script>